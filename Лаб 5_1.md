# Использование Google Test

### 1. Создание проекта Google Test в Visual Studio

1. Откройте Visual Studio.
2. Перейдите в меню File -> New -> Project.
3. В окне создания проекта выберите Google Test (этот шаблон доступен, если у вас установлена поддержка C++ и тестирования в Visual Studio).
   - Если шаблона Google Test нет, убедитесь, что у вас установлен компонент "Desktop Development with C++" и "Testing tools core features" в Visual Studio Installer.
4. Назовите проект, например, MyGoogleTests, и нажмите Create.

---

### 2. Структура проекта Google Test

После создания проекта вы увидите следующую структуру:
- **pch.h**: Precompiled header (может быть отключен, если не используется).
- **test.cpp**(может называться по-другому): Пример тестового файла, где вы будете писать свои тесты.

Visual Studio автоматически настраивает проект для использования Google Test, включая пути к библиотекам и заголовочным файлам.

---

### 3. Написание тестов

Теперь вы можете писать тесты в файле `test.cpp` или создать новый файл для тестов. Рассмотрим пример:

Объяснение:
>EXPECT_EQ — это макрос из библиотеки Google Test, который используется для проверки равенства двух значений в тестах. Если значения не равны, тест продолжит выполнение, но будет отмечен как неудачный. Это >отличает EXPECT_EQ от ASSERT_EQ, который немедленно завершает тест при неудачной проверке.
>
>
>### Как работает EXPECT_EQ
>
>#### Синтаксис:
>EXPECT_EQ(expected, actual);
>- expected: Ожидаемое значение.
>- actual: Фактическое значение, которое вы хотите проверить.
>
>#### Что происходит:
>1. Google Test сравнивает expected и actual с помощью оператора ==.
>2. Если значения равны, проверка считается успешной, и тест продолжает выполняться.
>3. Если значения не равны, Google Test сообщает об ошибке, но тест продолжает выполнение.


#### Пример тестового файла
```
#include "pch.h"  // Подключение precompiled header (если используется)
#include <gtest/gtest.h> // Не нужно, если есть в pch.h 

// Пример функции для тестирования
int Multiply(int a, int b) {
    return a * b;
}

// Тестовый случай для функции Multiply
TEST(MultiplyTest, HandlesPositiveInput) {
    EXPECT_EQ(Multiply(2, 3), 6);
    EXPECT_EQ(Multiply(5, 10), 50);
}

TEST(MultiplyTest, HandlesZeroInput) {
    EXPECT_EQ(Multiply(0, 5), 0);
    EXPECT_EQ(Multiply(10, 0), 0);
}

TEST(MultiplyTest, HandlesNegativeInput) {
    EXPECT_EQ(Multiply(-2, 3), -6);
    EXPECT_EQ(Multiply(-4, -5), 20);
}
```
---

### 4. Запуск тестов 
1. Соберите проект: нажмите **Build -> Build Solutiond Solution** (или `Ctrl + Shift + B`).
2. **Запустите тесты**:
   - Перейдите в меню **Test -> Run All Tests** (или используйте сочетание клавиш Ctrl + R, A).
   - Либо отеройте Test Explorer **Test -> Test Explorer**) и запустите тесты оттуда.

---

### 5. Использование Test Explorer

Test Explorer — это удобный инструмент для управления тестами в Visual Studio:
1. Откройте **Test Explorer (Test -> Windows -> Test Explorer**).
2. Здесь вы увидите список всех тестов, их статус (Passed/Failed) и время выполнения.
3. Вы можете запускать отдельные тесты, группировать их по категориям и анализировать результаты.

---

### 6. Добавление новых тестовых файлов

Если вы хотите добавить новый файл для тестов:
1. Щелкните правой кнопкой мыши на проект в Solution Explor.
2. Выберите Add -> New Item
3. Выберите **C++ File** и назовите его, например, `MoreTests.cpp`.
4. Напишите тесты в этом файле, не забывая подключить `#include <gtest/gtest.h>`.

Пример нового файла:

```
#include "pch.h"
#include <gtest/gtest.h>

TEST(MoreTests, SimpleTest) {
    EXPECT_TRUE(1 + 1 == 2);
}
```
---



## Пояснения

### Пример использования EXPECT_EQ

```cpp
#include <gtest/gtest.h>

// Пример функции для тестирования
int Add(int a, int b) {
    return a + b;
}

// Тестовый случай
TEST(AddTest, HandlesPositiveInput) {
    EXPECT_EQ(Add(1, 2), 3);  // Ожидаем, что 1 + 2 = 3
    EXPECT_EQ(Add(10, 20), 30);  // Ожидаем, что 10 + 20 = 30
}

TEST(AddTest, HandlesNegativeInput) {
    EXPECT_EQ(Add(-1, -2), -3);  // Ожидаем, что -1 + (-2) = -3
    EXPECT_EQ(Add(-10, -20), -30);  // Ожидаем, что -10 + (-20) = -30
}
```
---

### Что произойдет, если проверка не пройдет?

Если `expected` и `actual` не равны, Google Test выведет сообщение об ошибке, но тест продолжит выполнение. Например:

``` cpp
TEST(AddTest, HandlesIncorrectInput) {
    EXPECT_EQ(Add(1, 2), 4);  // Ожидаем 4, но получим 3
}

Вывод:
[ FAILED ] AddTest.HandlesIncorrectInput
Expected equality of these values:
  Add(1, 2)
    Which is: 3
  4
```
---

### Отличие `EXPECT_EQ` от `ASSERT_EQ`

- **`EXPECT_EQ`**:
  - Продолжает выполнение теста, даже если проверка не прошла.
  - Полезно, когда нужно проверить несколько условий в одном тесте.

- **`ASSERT_EQ`**:
  - Немедленно завершает тест, если проверка не прошла.
  - Полезно, когда дальнейшие проверки бессмысленны, если текущая проверка не удалась.

Пример:

``` cpp
TEST(AddTest, MixedAssertions) {
    ASSERT_EQ(Add(1, 2), 3);  // Если это не выполнится, тест завершится
    EXPECT_EQ(Add(2, 3), 5);  // Эта проверка выполнится только если предыдущая прошла
    EXPECT_EQ(Add(3, 4), 7);  // Эта проверка также выполнится
}
```
---

### Когда использовать `EXPECT_EQ`

Используйте `EXPECT_EQ`, когда:
- Вы хотите проверить несколько условий в одном тесте.
- Необходимо, чтобы тест продолжал выполнение, даже если одно из условий не выполнилось.

---

### Другие макросы для проверок в Google Test

Google Test предоставляет множество макросов для различных проверок:
- **`EXPECT_NE`**: Проверяет, что два значения **не равны**.
- **`EXPECT_LT`**: Проверяет, что первое значение **меньше** второго.
- **`EXPECT_LE`**: Проверяет, что первое значение **меньше или равно** второму.
- **`EXPECT_GT`**: Проверяет, что первое значение **больше** второго.
- **`EXPECT_GE`**: Проверяет, что первое значение **больше или равно** второму.
- **`EXPECT_TRUE`**: Проверяет, что условие истинно.
- **`EXPECT_FALSE`**: Проверяет, что условие ложно.

---

### Пример с другими макросами

```cpp
TEST(ComparisonTest, VariousChecks) {
    int a = 5, b = 10;

    EXPECT_NE(a, b);  // a != b
    EXPECT_LT(a, b);  // a < b
    EXPECT_LE(a, 5);  // a <= 5
    EXPECT_GT(b, a);  // b > a
    EXPECT_GE(b, 10); // b >= 10
    EXPECT_TRUE(a == 5);  // a равно 5
    EXPECT_FALSE(a == b); // a не равно b
}
```

TEST — это макрос из библиотеки Google Test, который используется для определения тестового случая (test case). Каждый тестовый случай содержит одну или несколько проверок (assertions), которые проверяют корректность работы вашего кода. В этом руководстве я подробно расскажу, как использовать TEST, как он работает и как его правильно применять.

---

### 1. Синтаксис макроса TEST

Макрос TEST имеет следующий синтаксис:

`TEST(TestSuiteName, TestName) {
    // Тестовые проверки
}
`
- **TestSuiteName**: Имя тестового набора (группы тестов). Обычно это имя класса или функциональности, которую вы тестируете.
- **TestName**: Имя конкретного теста. Оно должно описывать, что именно проверяется в этом тТело теста теста**: Внутри фигурных скобок {} вы пишете проверки (assertions), которые тестируют ваш код.

---

### 2. Пример использования TEST

Рассмотрим пример тестирования простой функции сложения двух чисел:
```
#include <gtest/gtest.h>

// Функция для тестирования
int Add(int a, int b) {
    return a + b;
}

// Тестовый случай для функции Add
TEST(AddTest, HandlesPositiveInput) {
    EXPECT_EQ(Add(1, 2), 3);  // Проверка, что 1 + 2 = 3
    EXPECT_EQ(Add(10, 20), 30);  // Проверка, что 10 + 20 = 30
}

TEST(AddTest, HandlesNegativeInput) {
    EXPECT_EQ(Add(-1, -2), -3);  // Проверка, что -1 + (-2) = -3
    EXPECT_EQ(Add(-10, -20), -30);  // Проверка, что -10 + (-20) = -30
}
```
---

### 3. Как работает TEST

1. **Группировка тестов**: TestSuiteName позволяет группировать тесты по функциональности. Например, все тесты для функции Add могут быть объединены в набор AddTest.
2. **Изоляция тестов**: Каждый тест выполняется изолированно от других. Это означает, что состояние одного теста не влияеПроверки
3. **Проверки**: Внутри теста вы используете макросы вроде EXPECT_EQ, ASSERT_TRUE и других для проверки корректности работы кода.

---

### 4. Запуск тестов

Когда вы запускаете тесты, Google Test автоматически находит все макросы TEST и выполняет их. Результаты выполнения выводятся в консоль или в Test Explorer в Visual Studio.

Пример вывода:
```
[==========] Running 2 tests from 1 test suite.
[----------] Global test environment set-up.
[----------] 2 tests from AddTest
[ RUN      ] AddTest.HandlesPositiveInput
[       OK ] AddTest.HandlesPositiveInput (0 ms)
[ RUN      ] AddTest.HandlesNegativeInput
[       OK ] AddTest.HandlesNegativeInput (0 ms)
[----------] 2 tests from AddTest (0 ms total)

[==========] 2 tests passed.
[==========] 0 tests failed.
```
---

### 5. Лучшие практики использования TEST

1. **Именование**:
   - Используйте понятные и описательные имена для TestSuiteName и TestName.
   - Имя теста должно отражать, что именно проверяется. Например, HandlesPositiveInput или ThrowsExceptionOnInvalidInput.

2. **Один тест — одна ответственность**:
   - Каждый тест должен проверять только одну конкретную функциональность или случай.
   - Не стоит объединять множество проверок в одном тесте, если они не связаны логически
   - Используйте EXPECT_* для проверок, которые не должны прерывать выполнение теста.
   - Используйте ASSERT_* для критических проверок, которые должны немедленно завершить тест при неудаче.
3. **Тестирование граничных случаев**:
   - Убедитесь, что вы тестируете не только "счастливый путь", но и граничные случаи, например:
     - Отрицательные числа.
     - Нулевые значения.
     - Максимальные/минимальные значения.



